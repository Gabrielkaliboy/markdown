---
title: H5新增表单验证api
date: 2017-12-05 20:55:40
categories: 前端
tags: [web记录]
---
<Excerpt in index | 首页摘要> 
    H5新增表单验证api
<!-- more -->
<The rest of contents | 余下全文>

-----

## 1.oninvalid
oninvalid：提交的input元素的值为无效值时(这里是不符合require)，触发oninvalid事件。oninvalid属于Form 事件。

```html
<form action="">
    <input type="text" required oninvalid="alert('123')">
    <input type="submit" value="提交">
</form>
```
上面的实例弹出123



## 2.setCustomValidity
setCustomValidity()：这个是HTML5内置的JS方法，用来自定义提示信息。一般和oninvalid配合使用
```html
    <form action="">
        <label for="userName">姓名：</label>
        <input type="text" id="userName" name="userName" required oninvalid="setCustomValidity('请输入姓名')">
        <input type="submit" value="提交">
    </form>
```

## 3.pattern
用来添加正则校验，这里要注意一下，pattern如果和oninvalid，setCustomValidity一起使用,会发生错误
```html
    <form action="">
        <label for="tel">手机号：</label>
        <input type="text" id="tel" name="tel" required  pattern="^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\d{8}$" oninvalid="setCustomValidity('请输入手机号')">
        <input type="submit" value="提交">
    </form>
```
**即使符合正则表达式，也一值报错**
这个问题有待解决

pattern如果和oninvalid，setCustomValidity一起在js中使用，这个问题同上
```html
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>有问题</title>
</head>

<body>
    <form action="">
        <label for="tel">手机号：</label>
        <input type="text" id="tel" name="tel" required pattern="^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\d{8}$">
        <input type="submit" value="提交">
    </form>
</body>
<script>
    var tel = document.getElementById('tel');
    tel.oninvalid = function (event) { 
        event.target.setCustomValidity('请输入正确的手机号');
         }

</script>
</html>
```
## 4.pattern和title一起使用，用来修改错误信息提示

```html
    <form action="">
        <label for="tel">手机号：</label>
        <input type="text" id="tel" name="tel" required  pattern="^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\d{8}$" oninvalid="setCustomValidity('请输入手机号')">
        <input type="submit" value="提交">
    </form>
```
**缺点就是**
错误信息提示里面会多加一句“请与所请求的格式保持一致”



## 5.oninput
　oninput 是 HTML5 的标准事件，对于检测 textarea, input:text, input:password 和 input:search 这几个元素通过用户界面发生的内容变化非常有用，在内容修改后立即被触发，不像 onchange 事件需要失去焦点才触发
```html
    <form action="">
        <label for="tel">手机号：</label>
        <input type="text" id="tel" name="tel" oninput="console.log(this.value);">
        <input type="submit" value="提交">
    </form>
```